<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1,user-scalable=no" />
  <title>WHO VQ — スタート</title>
  <meta name="color-scheme" content="light dark" />
  <style>
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    html, body { height: 100%; margin: 0; background: #000; color: #fff; font-family: system-ui,"Noto Sans JP","Segoe UI",Arial,sans-serif; }

    /* 背景 */
    .bg {
      position: fixed; inset: 0; z-index: 0; pointer-events: none;
      background-size: cover; background-position: center; opacity: 0; transition: opacity 900ms ease;
      filter: saturate(1.02) contrast(1.02);
    }
    .bg.show { opacity: 1; }
    .vignette {
      position: fixed; inset: 0; z-index: 1; pointer-events: none;
      background:
        radial-gradient(1200px 500px at 50% 0%, rgba(0,0,0,.1), transparent 50%),
        linear-gradient(180deg, rgba(0,0,0,.25) 0%, rgba(0,0,0,.35) 60%, rgba(0,0,0,.55) 100%);
    }

    /* 上部バー */
    #topbar {
      position: fixed; top: 0; left: 0; right: 0; z-index: 2;
      display: flex; align-items: center; justify-content: space-between;
      padding: 10px 12px;
      background: linear-gradient(180deg, rgba(0,0,0,.55), rgba(0,0,0,0));
    }
    #brand { font-weight: 700; letter-spacing: .03em; text-shadow: 0 2px 10px rgba(0,0,0,.35); }
    .right { display: flex; gap: 8px; align-items: center; }
    select {
      height: 36px; border-radius: 10px; border: 1px solid rgba(255,255,255,.25);
      background: rgba(0,0,0,.35); color: #fff; padding: 0 10px; font-size: 14px;
      backdrop-filter: blur(6px);
    }

    /* メイン */
    main.center {
      position: relative; z-index: 2; height: 100%;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      text-align: center; padding: 16px;
    }
    main.center h1 { font-size: clamp(26px, 6vw, 42px); margin: 0 0 8px; text-shadow: 0 2px 12px rgba(0,0,0,.5); }
    main.center .subtitle { font-size: clamp(14px, 4vw, 18px); margin-bottom: 28px; color: rgba(255,255,255,.9); }

    .buttons { display: flex; flex-direction: column; gap: 14px; width: min(340px, 82vw); }
    .btn {
      padding: 14px; border: none; border-radius: 14px;
      font-size: clamp(16px, 4vw, 18px); font-weight: 700;
      color: #fff; cursor: pointer; transition: transform .06s ease, opacity .2s ease;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.35), 0 8px 20px rgba(0,0,0,.35);
    }
    .btn:active { transform: translateY(1px) scale(.98); }
    .btn.primary { background: linear-gradient(180deg, rgba(255,255,255,.25), rgba(255,255,255,.08)); }
    .btn.secondary { background: rgba(255,255,255,.15); font-weight: 600; }
    .btn.ghost { background: rgba(255,255,255,.08); font-weight: 500; }
    .btn.disabled { opacity: .6; pointer-events: none; }

    footer {
      position: fixed; bottom: 6px; left: 0; right: 0; z-index: 2;
      display: grid; place-items: center; font-size: 11px; color: rgba(255,255,255,.8);
      text-shadow: 0 1px 6px rgba(0,0,0,.6);
    }
  </style>
</head>
<body>
  <!-- 背景 -->
  <div id="bg-sunrise" class="bg" style="background-image:url('public/items/bg/sunrise.jpg');"></div>
  <div id="bg-day" class="bg" style="background-image:url('public/items/bg/beach_day.jpg');"></div>
  <div id="bg-night" class="bg" style="background-image:url('public/items/bg/night_beach.jpg');"></div>
  <div class="vignette"></div>

  <!-- トップバー -->
  <header id="topbar">
    <div id="brand">WHO VQ</div>
    <div class="right">
      <select id="lang" aria-label="Language">
        <option value="ja">日本語</option>
        <option value="zh">中文</option>
        <option value="en">English</option>
        <option value="ko">한국어</option>
      </select>
    </div>
  </header>

  <!-- メイン -->
  <main class="center">
    <h1 data-i18n="title">WHO VQ</h1>
    <p class="subtitle" data-i18n="subtitle">あなたのお世話が、誰かの世界に</p>
    <div class="buttons">
      <button class="btn primary"   id="btnStart"    data-i18n="start">スタート</button>
      <button class="btn secondary" id="btnContinue" data-i18n="continue">続きから</button>
      <button class="btn ghost"     id="btnAbout"    data-i18n="about">研究について</button>
      <button class="btn ghost"     id="btnGame"     data-i18n="game">ゲーム説明</button>
    </div>
  </main>

  <footer><div id="foot" data-i18n="footer">© WHO VQ Project</div></footer>

  <script>
    const I18N = {
      ja: {
        title: "WHO VQ",
        subtitle: "あなたのお世話が、誰かの世界に",
        start: "スタート",
        continue: "続きから",
        about: "研究について",
        game: "ゲーム説明",
        footer: "© WHO VQ プロジェクト"
      },
      zh: {
        title: "WHO VQ",
        subtitle: "你的照顾，会成为别人的世界",
        start: "开始",
        continue: "继续",
        about: "关于研究",
        game: "游戏说明",
        footer: "© WHO VQ 项目"
      },
      en: {
        title: "WHO VQ",
        subtitle: "Your care becomes someone’s world",
        start: "Start",
        continue: "Continue",
        about: "About Research",
        game: "Game Guide",
        footer: "© WHO VQ Project"
      },
      ko: {
        title: "WHO VQ",
        subtitle: "당신의 돌봄이 누군가의 세상이 됩니다",
        start: "시작",
        continue: "이어하기",
        about: "연구에 대하여",
        game: "게임 설명",
        footer: "© WHO VQ 프로젝트"
      }
    };

    const LS_KEYS = { lang: "who_lang", last: "who_lastPage" };

    const bg = {
      sunrise: document.getElementById('bg-sunrise'),
      day: document.getElementById('bg-day'),
      night: document.getElementById('bg-night'),
    };
    function showBG(name) {
      Object.values(bg).forEach(el => el.classList.remove('show'));
      (bg[name] || bg.day).classList.add('show');
      localStorage.setItem('who_bg', name);
    }
    function decideBGByTime() {
      const hour = new Date().getHours();
      if (hour >= 5 && hour < 9) return 'sunrise';
      if (hour >= 9 && hour < 18) return 'day';
      return 'night';
    }

    const langSel = document.getElementById('lang');
    function applyLang(lang) {
      const dict = I18N[lang] || I18N.ja;
      document.querySelectorAll('[data-i18n]').forEach(el => {
        const key = el.getAttribute('data-i18n');
        if (dict[key]) el.textContent = dict[key];
      });
      document.documentElement.lang = lang;
      localStorage.setItem(LS_KEYS.lang, lang);
    }

    const btnStart    = document.getElementById('btnStart');
    const btnContinue = document.getElementById('btnContinue');
    const btnAbout    = document.getElementById('btnAbout');
    const btnGame     = document.getElementById('btnGame');

    btnStart.addEventListener('click', () => {
      const next = 'char.html';
      localStorage.setItem(LS_KEYS.last, next);
      location.href = next;
    });

    btnContinue.addEventListener('click', () => {
      const last = localStorage.getItem(LS_KEYS.last);
      location.href = last || 'char.html';
    });

    btnAbout.addEventListener('click', () => {
      localStorage.setItem(LS_KEYS.last, 'about.html');
      location.href = 'about.html';
    });

    btnGame.addEventListener('click', () => {
      localStorage.setItem(LS_KEYS.last, 'game.html');
      location.href = 'game.html';
    });

    (function boot(){
      const savedBG = localStorage.getItem('who_bg') || decideBGByTime();
      showBG(savedBG);

      const savedLang = localStorage.getItem(LS_KEYS.lang);
      const guess = (navigator.language || 'ja').toLowerCase();
      const fromBrowser = guess.startsWith('ja') ? 'ja' :
                          guess.startsWith('zh') ? 'zh' :
                          guess.startsWith('ko') ? 'ko' : 'en';
      const lang = savedLang || fromBrowser;
      langSel.value = lang; applyLang(lang);
      langSel.addEventListener('change', e => applyLang(e.target.value));

      const last = localStorage.getItem(LS_KEYS.last);
      if (!last) btnContinue.classList.add('disabled');
    })();
  </script>
</body>
</html>
